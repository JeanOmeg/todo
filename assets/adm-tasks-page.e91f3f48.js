import{T as h,u as _,Q as T,a as f}from"./ToolBar.0797b8c4.js";import{z as b,s as k,o as v,G as w,_ as $,A,B,H as I,E as s,D as d,I as Q,J as u,L as x}from"./index.bf12d20e.js";import{Q as P,a as E,b as S}from"./QPullToRefresh.83efdbcb.js";import{api as p}from"./axios.cef7f351.js";import"./QResizeObserver.2a831276.js";import"./QSelect.a066692f.js";function C(e){return{listAllTasks:async()=>{try{const{data:t}=await p.get(e);return t}catch(t){throw new Error(t)}},remove:async t=>{try{const{data:a}=await p.delete(`${e}/${t}`);return a}catch(a){throw new Error(a)}},getById:async t=>{try{const{data:a}=await p.get(`${e}/${t}`);return a}catch(a){throw new Error(a)}}}}function D(){const{listAllTasks:e,remove:c,getById:i}=C("admtasks");return{listAllTasks:e,remove:c,getById:i}}var q=b({name:"AdmTasksPage",components:{ToolBar:h},setup(){const e=k([]),{listAllTasks:c,remove:i}=D();v(()=>{localStorage.getItem("logout")===null||localStorage.getItem("logout")==="true"?a.push({name:"notFound"}):localStorage.getItem("admin")==="false"||localStorage.getItem("admin")===null?a.push({name:"notFound"}):m()});const g=[{name:"index",label:"#",field:"index",align:"left",sortable:!0},{name:"id",field:"id",label:"Task ID",align:"left",sortable:!0},{name:"title",field:"title",label:"Task",align:"left",sortable:!0},{name:"username",field:"username",label:"Username",align:"left",sortable:!0},{name:"status",field:"status",label:"Status",align:"left",sortable:!0},{name:"created",field:"created",label:"Create",align:"left",sortable:!0},{name:"updated",field:"updated",label:"Update",align:"left",sortable:!0},{name:"actions",field:"actions",label:"Actions",align:"right"}],t=_(),a=w();let r=[],l=[];const m=async()=>{try{const o=await c();e.value=o,l=e.value,r=[];for(let n=0;n<l.length;n++)r=r.concat(l[n]);r.forEach((n,y)=>{n.index=++y})}catch(o){t.notify({message:"Not logged!",icon:"error",color:"negative"}),console.log(o)}};return{tasks:e,columns:g,deleteTask:async o=>{try{t.dialog({title:"Delete",message:"Do you want to delete this task?",cancel:!0,persistent:!0}).onOk(async()=>{await i(o),t.notify({message:"Deleted",icon:"check",color:"positive"}),m()})}catch{t.notify({message:"Error!",icon:"times",color:"negative"})}},pagination:k({rowsPerPage:0}),refresh(o){setTimeout(()=>{m(),o()},1e3)}}}});const R=q,z={class:"row justify-center items-center content-center col-12"},F={class:"col-8 q-gutter-sm q-col-gutter-sm"},N=u("div",{class:"row justify-center text-bold text-primary",style:{"font-size":"1.5em"}}," All platform tasks ",-1),j=u("span",{class:"text-h5"},"Tasks",-1);function L(e,c,i,g,t,a){const r=A("tool-bar");return B(),I(Q,null,[s(r),s(T,null,{default:d(()=>[u("div",z,[u("div",F,[s(f),N,s(f),s(P,{onRefresh:e.refresh},{default:d(()=>[s(E,{title:"Tasks",rows:e.tasks,columns:e.columns,"row-key":"index",class:"my-sticky-virtscroll-table"},{top:d(()=>[j,s(f)]),"body-cell-actions":d(l=>[s(S,{props:l,class:"q-gutter-sm"},{default:d(()=>[s(x,{icon:"delete",color:"negative",dense:"",size:"sm",onClick:m=>e.deleteTask(l.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1},8,["onRefresh"])])])]),_:1})],64)}var K=$(R,[["render",L]]);export{K as default};
